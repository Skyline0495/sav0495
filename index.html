<!DOCTYPE html>
<html>
<head>
    <title>–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ç–∞–π–º–µ—Ä</title>
    <style>
        body { font-family: Arial; text-align: center; padding: 20px; }
        #timer { font-size: 72px; margin: 20px; color: #333; }
        button { 
            padding: 12px 24px; 
            font-size: 18px; 
            background: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            cursor: pointer;
        }
        #hostControls { margin: 20px; }
    </style>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
</head>
<body>
    <h1>–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ç–∞–π–º–µ—Ä</h1>
    <div id="timer">00:00</div>

    <div id="hostControls">
        <button id="startBtn">üöÄ –°—Ç–∞—Ä—Ç (–¢–æ–ª—å–∫–æ –¥–ª—è —Ö–æ—Å—Ç–∞)</button>
    </div>

    <script>
        // –í–∞—à–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Firebase (—è –ø–æ–¥—Å—Ç–∞–≤–∏–ª –∏—Ö –∏–∑ –≤–∞—à–µ–≥–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞)
        const firebaseConfig = {
            apiKey: "A1zaSyDoCb9XRTBwXsjWLsaDgFvGh2c1H6DSHgA",
            authDomain: "superTimer-dc53c.firebaseapp.com",
            databaseURL: "https://superTimer-dc53c-defaulf-rtdb.europe-west1.firebasedatabase.app",
            projectId: "superTimer-dc53c",
            storageBucket: "superTimer-dc53c.appspot.com",
            messagingSenderId: "624576534672",
            appId: "1:624576534672:web:5eae9e01aa1ba8114c6015"
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Ö–æ—Å—Ç –ª–∏ —ç—Ç–æ
        const isHost = window.location.hash === "#host";
        if (!isHost) document.getElementById('hostControls').style.display = 'none';

        // –ó–∞–ø—É—Å–∫ —Ç–∞–π–º–µ—Ä–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ö–æ—Å—Ç–∞)
        document.getElementById('startBtn').addEventListener('click', () => {
            if (!isHost) return;
            
            // –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–∞–π–º–µ—Ä–∞ (5 —Ä–∞—É–Ω–¥–æ–≤ –ø–æ 5 –º–∏–Ω—É—Ç)
            const settings = {
                timeLeft: 300, // 5 –º–∏–Ω—É—Ç –≤ —Å–µ–∫—É–Ω–¥–∞—Ö
                currentRound: 1,
                totalRounds: 5,
                isRunning: true
            };
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ Firebase
            database.ref('timer').set(settings);
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Ç—Å—á–µ—Ç
            setInterval(() => {
                database.ref('timer/timeLeft').transaction((current) => {
                    return current > 0 ? current - 1 : 0;
                });
            }, 1000);
        });

        // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –¥–ª—è –≤—Å–µ—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        database.ref('timer').on('value', (snapshot) => {
            const data = snapshot.val();
            if (!data) return;
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è (05:00)
            const mins = String(Math.floor(data.timeLeft / 60)).padStart(2, '0');
            const secs = String(data.timeLeft % 60).padStart(2, '0');
            document.getElementById('timer').textContent = `${mins}:${secs}`;
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¢–∞–π–º–µ—Ä</title>
  <style>
    body {
      font-family: sans-serif;
      text-align: center;
      margin-top: 50px;
    }
    input, button {
      font-size: 18px;
      padding: 5px 10px;
    }
    .timer {
      font-size: 48px;
      margin-top: 20px;
    }
  </style>
</head>
<body>

  <h1>–°–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ç–∞–π–º–µ—Ä –ø–æ —Ä–∞—É–Ω–¥–∞–º</h1>

  <label>‚è± –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞—É–Ω–¥–∞ (—Å–µ–∫):</label>
  <input type="number" id="roundDuration" value="30"><br><br>

  <label>üîÅ –ö–æ–ª-–≤–æ —Ä–∞—É–Ω–¥–æ–≤:</label>
  <input type="number" id="roundCount" value="5"><br><br>

  <button onclick="startTimer()">–°—Ç–∞—Ä—Ç</button>

  <div class="timer" id="timer">00:00</div>
  <div id="roundInfo"></div>

  <script>
    let startTime = null;
    let intervalId = null;

    function startTimer() {
      const duration = parseInt(document.getElementById("roundDuration").value);
      const count = parseInt(document.getElementById("roundCount").value);

      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥–ª–æ–±–∞–ª—å–Ω–æ–µ —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ –≤—Ä–µ–º—è (timestamp)
      startTime = Date.now();
      localStorage.setItem("timerStartTime", startTime);
      localStorage.setItem("roundDuration", duration);
      localStorage.setItem("roundCount", count);

      runTimer();
      clearInterval(intervalId);
      intervalId = setInterval(runTimer, 1000);
    }

    function runTimer() {
      const duration = parseInt(localStorage.getItem("roundDuration"));
      const count = parseInt(localStorage.getItem("roundCount"));
      startTime = parseInt(localStorage.getItem("timerStartTime"));

      const now = Date.now();
      const elapsedSec = Math.floor((now - startTime) / 1000);

      const currentRound = Math.floor(elapsedSec / duration) + 1;
      const timeInRound = elapsedSec % duration;
      const timeLeft = duration - timeInRound;

      if (currentRound > count) {
        document.getElementById("timer").textContent = "–†–∞—É–Ω–¥—ã –∑–∞–≤–µ—Ä—à–µ–Ω—ã!";
        document.getElementById("roundInfo").textContent = "";
        clearInterval(intervalId);
        return;
      }

      document.getElementById("timer").textContent =
        timeLeft.toString().padStart(2, "0") + " —Å–µ–∫";
      document.getElementById("roundInfo").textContent =
        "–†–∞—É–Ω–¥ " + currentRound + " –∏–∑ " + count;
    }

    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ–º —Ç–∞–π–º–µ—Ä, –µ—Å–ª–∏ —É–∂–µ –∑–∞–ø—É—â–µ–Ω
    if (localStorage.getItem("timerStartTime")) {
      intervalId = setInterval(runTimer, 1000);
    }
  </script>

</body>
</html>
